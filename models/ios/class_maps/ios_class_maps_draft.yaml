module: ios_class_maps
version_added: 0.01
short_description: Manages Class-Maps on IOS devices.
description: This module configures and manages Class-Maps on IOS platforms.
author: Ambrus Fay (@fay-ambrus)
notes:
    - Tested against Cisco IOSXE version 17.3 on CML.
    - This module works with connection C(network_cli).
      See L(IOS Platform Options,../network/user_guide/platform_ios.html).
options:
  config:
    description: A dictionary of Class-Map options.
    type: list
    elements: dict
    suboptions:
        name:
            description:
                - The name of the Class-Map.
            required: true
            type: str
        match_type:
            description:
                - Determines how packets are evaluated when multiple match criteria exist.
            default: match-all
            type: str
            choices:
                - match-all
                - match-any
        class_map_type:
            description:
                - Determines the type of the class map.
                - For more informtion on different Class-Map types, refer to the manual.
            default: inspect
            type: str
            choices:
                - access-control
                - appnav
                - control
                - inspect
                - multicast-flows
                - site-manager
                - stack
                - traffic
        class_map_decription:
            description:
                - Class-Map description
            type: str
        matches:
            description:
                - classification criteria
            type: list
            elements: dict
            suboptions:
                access_groups:
                    description:
                        - Access-groups to match.
                        - Identified by a name or number.
                    type: dict
                    mutually_exclusive: [name, number]
                    suboptions:
                        name:
                            description:
                                - Specifies a named ACL.
                                - The name can be up to 40 alphanumeric characters.
                            type: str
                        number:
                            description:
                                - Specifies a numbered ACL.
                                - The range is from 1 to 2699.
                            type: int
                any:
                    description:
                        - Configures the match criteria to be successful for all packets.
                    type: bool
                application_metadata:
                    description:
                        - Use application metadata as a match criterion for classification.
                    type: list
                    elements: dict
                    mutually_exclusive: [regexp, application_group, attribute, application_name]
                    suboptions:
                        application_group:
                            description:
                                - Application Group to match
                            type: str
                            choices:
                                - telepresence-group
                                - vmware-group
                                - webex-group
                        application:
                            description:
                                - Specific applications to match.
                                - Also restrictable to source, vendor etc.
                            type: dict
                            mutually_exclusive: [application_name, application_name_regexp]
                            suboptions:
                                application_name:
                                    description: The name of the application to match.
                                    type: dict
                                    suboptions:
                                        cisco_phone:
                                            description: Cisco IP Phones and PC-based Unified Communicators
                                            type: dict
                                            suboptions:
                                                traffic_type:
                                                    description: Traffic Type
                                                    type: str
                                                    choices:
                                                        - control
                                                transport_type:
                                                    description: Transport Type
                                                    type: str
                                                    choices:
                                                        - rtcp
                                                        - rtp
                                                multiplex_type:
                                                    description: Multiplex Type
                                                    type: str
                                                    choices:
                                                        - set
                                                        - unset
                                                signaling_type:
                                                    description: Signaling Type
                                                    type: str
                                                    choices:
                                                        - bfcp
                                                        - h323
                                                        - mgcp
                                                        - sip
                                                        - skinny
                                        citrix:
                                            description: Citrix Application
                                            type: dict
                                            suboptions:
                                                traffic_type:
                                                    description: Traffic Type
                                                    type: str
                                                    choices:
                                                        - background
                                                        - bulk
                                                        - desktop
                                                        - interactive
                                                        - realtime
                                                        - session
                                                        - streaming
                                                        - tunnel
                                                transport_type:
                                                    description: Transport Type
                                                    type: str
                                                    choices:
                                                        - ica
                                                        - rdp
                                        h323:
                                            description:
                                            type: bool
                                        ip-camera:
                                            description:
                                            type: dict
                                            suboptions:
                                                traffic_type:
                                                    description: Traffic Type
                                                    type: str
                                                    choices:
                                                        - realtime
                                                transport_type:
                                                    description: Transport Type
                                                    type: str
                                                    choices:
                                                        - rtp
                                                multiplex_type:
                                                    description: Multiplex Type
                                                    type: str
                                                    choices:
                                                        - set
                                                        - unset
                                                signaling_type:
                                                    description: Signaling Type
                                                    type: str
                                                    choices:
                                                        - rtsp
                                        jabber:
                                            description:
                                            type: bool
                                        rtp:
                                            description:
                                            type: bool
                                        rtsp:
                                            description:
                                            type: bool
                                        sip:
                                            description:
                                            type: bool
                                        surveillance-distribution:
                                            description:
                                            type: dict
                                            suboptions:
                                                traffic_type:
                                                    description: Traffic Type
                                                    type: str
                                                    choices:
                                                        - realtime
                                                        - streaming
                                                transport_type:
                                                    description: Transport Type
                                                    type: str
                                                    choices:
                                                        - rtp
                                                multiplex_type:
                                                    description: Multiplex Type
                                                    type: str
                                                    choices:
                                                        - set
                                                        - unset
                                                signaling_type:
                                                    description: Signaling Type
                                                    type: str
                                                    choices:
                                                        - rtsp
                                        telepresence-control:
                                            description:
                                            type: dict
                                            suboptions:
                                                signaling_type:
                                                    description: Signaling Type
                                                    type: str
                                                    choices:
                                                        - bfcp
                                                        - ccp
                                                        - clue
                                                        - h323
                                                        - mscp
                                                        - sip
                                                        - xccp
                                        telepresence-data:
                                            description:
                                            type: bool
                                        telepresence-media:
                                            description:
                                            type: dict
                                            suboptions:
                                                traffic_type:
                                                    description: Traffic Type
                                                    type: str
                                                    choices:
                                                        - control
                                                transport_type:
                                                    description: Transport Type
                                                    type: str
                                                    choices:
                                                        - rtcp
                                                        - rtp
                                                multiplex_type:
                                                    description: Multiplex Type
                                                    type: str
                                                    choices:
                                                        - set
                                                        - unset
                                        vmware-view:
                                            description:
                                            type: dict
                                            suboptions:
                                                traffic_type:
                                                    description: Traffic Type
                                                    type: str
                                                    choices:
                                                        - desktop
                                                        - desktop-feedback
                                                        - session
                                                        - streaming
                                                        - tunnel
                                                        - usb-redirection
                                                transport_type:
                                                    description: Transport Type
                                                    type: str
                                                    choices:
                                                        - pcoip
                                                        - rdp
                                        webex-meeting:
                                            description:
                                            type: dict
                                            suboptions:
                                                traffic_type:
                                                    description: Traffic Type
                                                    type: str
                                                    choices:
                                                        - control
                                                        - sharing
                                                        - streaming
                                                transport_type:
                                                    description: Transport Type
                                                    type: str
                                                    choices:
                                                        - http
                                        wyze-zero-client:
                                            description:
                                            type: dict
                                            suboptions:
                                                traffic_type:
                                                    description: Traffic Type
                                                    type: str
                                                    choices:
                                                        - streaming
                                        xmpp-client:
                                            description:
                                            type: bool
                                application_name_regexp:
                                    description: Match all packets with applicaiton name matching the given regular expression.
                                    type: str
                                source:
                                    description: Specifies the source of the application.
                                    type: str
                                    choices:
                                        - cli
                                        - cube
                                        - msp
                                        - nbar
                                        - rfmd
                                        - rsvp
                                        - cac
                                vendor:
                                    description:
                                        - Specifies the name of the vendor.
                                        - Refer to the manual to get a list of supported vendors for the respective application name.
                                    type: str
                                version:
                                    description: Specifies the version number.
                                    type: str
                        attribute:
                            description:
                                - Specifies the relevant attribute to match.
                            type: dict
                            suboptions:
                                category:
                                    description:
                                        - Specifies the category type that the control plane classification engine must match.
                                    type: str
                                    choices:
                                        - business-and-productivity-tools
                                        - physical-security
                                        - voice-and-video
                                device_class:
                                    description:
                                        - Specifies the device class to match.
                                    type: str
                                    choices:
                                        - desktop-conferencing
                                        - desktop-virtualization
                                        - physical-phone
                                        - room-conferencing
                                        - software-phone
                                        - surveillance
                                media_type:
                                    description:
                                        - Specifies the type of media to match.
                                    type: str
                                    choices:
                                        - audio
                                        - audio-video
                                        - control
                                        - data
                                        - video
                                sub_category:
                                    description:
                                        - Specifies the subcategory to match.
                                    type: str
                                    choices:
                                        - control-and-signaling
                                        - remote-access-terminal
                                        - video-surveillance
                                        - voice-video-chat-collaboration
                                tcl:
                                    description:
                                        - Traffic Class Label to match.
                                    type: str
                cac_status:
                    description: Call Admission Control
                    type: str
                    choices:
                        - admitted
                        - un-admitted
                class_map_name:
                    description: Name of the traffic class to use as a match criterion.
                    type: str
                cos:
                    description:
                        - Match a packet on the basis of a Layer 2 class of service (CoS)/Inter-Switch Link (ISL) marking
                        - Up to 8  class-of-service values may be entered
                    type: list
                    elements: int
                cos_inner:
                    description: 
                        - Match the inner cos of QinQ packets on a Layer 2 class of service (CoS) marking
                        - UP to 4 class-of-service values may be entered.
                    type: list
                    elements: int
                desination_address_mac:
                    description:
                        - Use the destination MAC address as a match criterion
                        - address format -> 00:00:00:00:00:00
                    type: str
                discard_class:
                    description:
                        - Number of the discard class being matched.
                        - Valid values are 0 to 7.
                    type: int
                dscp:
                    description: 
                    type: dict
                    suboptions:
                        dscp_values:
                            description: Numbers (0 to 63) representing differentiated services code point values
                            type: list
                            elements: int
                        dscp_af_values:
                            description: AF numbers (for example, af11) identifying specific AF DSCPs
                            type: dict
                            suboptions:
                                af11:
                                    description: Match packets with AF11 dscp (001010)
                                    type: bool
                                af12:
                                    description: Match packets with AF12 dscp (001100)
                                    type: bool
                                af13:
                                    description: Match packets with AF13 dscp (001110)
                                    type: bool
                                af21:
                                    description: Match packets with AF21 dscp (010010)
                                    type: bool
                                af22:
                                    description: Match packets with AF22 dscp (010100)
                                    type: bool
                                af23:
                                    description: Match packets with AF23 dscp (010110)
                                    type: bool
                                af31:
                                    description: Match packets with AF31 dscp (011010)
                                    type: bool
                                af32:
                                    description: Match packets with AF32 dscp (011100)
                                    type: bool
                                af33:
                                    description: Match packets with AF33 dscp (011110)
                                    type: bool
                                af41:
                                    description: Match packets with AF41 dscp (100010)
                                    type: bool
                                af42:
                                    description: Match packets with AF42 dscp (100100)
                                    type: bool
                                af43:
                                    description: Match packets with AF43 dscp (100110)
                                    type: bool
                        dscp_cp_values:
                            dscription: CS numbers (for example, cs1) identifying specific CS DSCPs
                            type: dict
                            suboptions:
                                cs1:
                                    description: Match packets with CS1(precedence 1) dscp (001000)
                                    type: bool
                                cs2:
                                    description: Match packets with CS2(precedence 2) dscp (010000)
                                    type: bool
                                cs3:
                                    description: Match packets with CS3(precedence 3) dscp (011000)
                                    type: bool
                                cs4:
                                    description: Match packets with CS4(precedence 4) dscp (100000)
                                    type: bool
                                cs5:
                                    description: Match packets with CS5(precedence 5) dscp (101000)
                                    type: bool
                                cs6:
                                    description: Match packets with CS6(precedence 6) dscp (110000)
                                    type: bool
                                cs7:
                                    description: Match packets with CS7(precedence 7) dscp (111000)
                                    type: bool
                        default_value:
                            description: Match packets with default dscp (000000)
                            type: bool
                        ef_value:
                            description: Match packets with EF dscp (101110)
                            type: bool
                        
                
  state:
    choices:
      - merged
      - replaced
      - overridden
      - deleted
      - gathered
      - rendered
      - parsed
    default: merged
    description: description here
    type: str